#.................................................................................................................
# M402 - No additional options / Usage: M402
#
# Dock the (Stow) Euclid Probe
#
#.................................................................................................................
# Required variable(s) to be set. Add the following to your global variable dictionary block as:
#
## ---NONE---
#.................................................................................................................
# Required external macro(s) used by this macro.
#
# _CheckProbe
# _CG28
# _PROBE_STOW
# DOCK_PROBE_UNLOCK
#.................................................................................................................

#.................................................................................................................
#
## URL Resources: https://github.com/rkolbi/voron2.4/blob/main/MY_V24-350/ACTIVE/MACRO-EUCLID(GM).cfg
#      
#.................................................................................................................

#.................................................................................................................
# M402 - Stow Euclid Probe
[gcode_macro M402]
description: Stows the Euclid probe
gcode:
    # _CheckProbe action=query
    # {% set Z_POS = printer.toolhead.position.z %}
    # {% if not printer.probe.last_query %}
        # M118 Stowing Euclid Probe.
        # _CG28
        # G90
        # {% if Z_POS < 15 %} G0 Z15 {% endif %}
        # _PROBE_STOW
      # {% else %}
        # M118 ?!Attempted to Stow probe but it is not attached.
    # {% endif %}
    DOCK_PROBE_UNLOCK